{
  "long_term_memory": "Data model:\n- Prisma schema: User, Agent, Customer, Message, Driver, Vehicle, AdminUser, AuditLog, ProfileShare.\n- User has emailVerified boolean for OTP verification.\n- PostgreSQL database via DATABASE_URL (dev + staging).\n- Agent/Customer list fields stored as JSON strings.\n- ProfileShare stores token + code hash, sections, snapshot, editable flag, status, pending edits/status, optional recipient name, and last access time.\n\nAPIs:\n- Express server in connsura-backend/src/server.js.\n- CORS origin FRONTEND_URL (default http://localhost:5173).\n- Routes: /auth, /agents, /customers, /search, /quotes, /contact, /admin, /messages, /shares.\n- Auth OTP endpoints for logged-in users: POST /auth/email-otp/request and /auth/email-otp/confirm.\n- Share endpoints: POST /shares (create), POST /shares/:token/verify (code + optional name), POST /shares/:token/edits, POST /shares/:token/approve, POST /shares/:token/decline, POST /shares/:token/revoke, POST /shares/:token/close, GET /shares/pending, GET /shares/active.\n- Static: /uploads and /forms.\n- Agent endpoints include profile update, photo upload, SCC lookup, request flow.\n- Customer endpoints include profile read/update, photo upload, sharing preferences, profileData patch.\n- Customer share update blocks unverified emails when sharedWithAgent=true.\n- Admin endpoints include login, OTP lookup, agent/client management, audit logs.\n\nRuntime:\n- Deploy env sets HOST=0.0.0.0, PORT=8000, FRONTEND_URL=https://<domain>, DATABASE_URL=postgresql://<user>:<password>@postgres:5432/<db> (from /opt/connsura/env/backend.env).\n- Admin seed runs if ADMIN_EMAIL/ADMIN_PASSWORD are set.\n\nDecisions:\n- Serve uploads and forms directly from backend.\n\nOpen questions:\n- Production DB choice and migration strategy.\n- Logging/monitoring stack not defined.\n\nNext steps:\n- Keep API docs aligned with route changes.\n- Update memory after major backend changes.",
  "messages": [],
  "docs_index": {
    "embedding_model": "text-embedding-3-small",
    "chunks": []
  }
}


<style>
  .driver-meta {
    margin-bottom: 12px;
  }
  .driver-scroll {
    position: relative;
    padding: 0 44px;
  }
  .driver-container {
    display: flex;
    gap: 12px;
    overflow: hidden;
    scroll-behavior: smooth;
  }
  .driver-card {
    margin: 0;
    min-width: 320px;
    max-width: 360px;
    flex: 0 0 auto;
  }
  .driver-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 32px;
    height: 64px;
    border: 1px solid var(--border, #b7b2a4);
    background: var(--panel-bg, #fdfcf8);
    cursor: pointer;
    font-size: 20px;
    color: var(--accent, #6b6257);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    opacity: 0.9;
  }
  .driver-nav:hover {
    opacity: 1;
  }
  .driver-nav.prev {
    left: 4px;
  }
  .driver-nav.next {
    right: 4px;
  }
</style>

<div class="form-card driver-meta">
  <div class="card-title">Driver Information</div>
  <div class="form-grid wide">
    <label class="field-label" for="driver-count">Number of Drivers:</label>
    <div class="field-control">
      <input id="driver-count" name="driver-count" type="number" min="1" max="10" step="1" value="1" />
    </div>
  </div>
</div>

<div class="driver-scroll">
  <button type="button" class="driver-nav prev" aria-label="Previous driver">&lt;</button>
  <div id="driverContainer" class="driver-container"></div>
  <button type="button" class="driver-nav next" aria-label="Next driver">&gt;</button>
</div>

<template id="driverTemplate">
  <div class="form-card driver-card">
    <div class="card-title">Driver <span class="driver-label"></span></div>
    <div class="form-grid wide">
      <label class="field-label" data-for="drv-first"><span class="required">*</span> First Name:</label>
      <div class="field-control"><input data-base="drv-first" type="text" /></div>

      <label class="field-label" data-for="drv-middle">Middle Name:</label>
      <div class="field-control"><input data-base="drv-middle" type="text" /></div>

      <label class="field-label" data-for="drv-last"><span class="required">*</span> Last Name:</label>
      <div class="field-control"><input data-base="drv-last" type="text" /></div>

      <label class="field-label" data-for="drv-suffix">Suffix:</label>
      <div class="field-control"><input data-base="drv-suffix" type="text" /></div>

      <label class="field-label" data-for="drv-dob"><span class="required">*</span> Date of Birth:</label>
      <div class="field-control"><input data-base="drv-dob" type="date" /></div>

      <label class="field-label" data-for="drv-gender">Gender:</label>
      <div class="field-control">
        <select data-base="drv-gender">
          <option value="">Select</option><option>Male</option><option>Female</option><option>Non-Binary</option>
        </select>
      </div>

      <label class="field-label" data-for="drv-marital">Marital Status:</label>
      <div class="field-control">
        <select data-base="drv-marital">
          <option value="">Select</option><option>Single</option><option>Married</option><option>Separated</option><option>Divorced</option><option>Widowed</option>
        </select>
      </div>

      <label class="field-label" data-for="drv-relationship">Relationship:</label>
      <div class="field-control"><input data-base="drv-relationship" type="text" /></div>

      <label class="field-label" data-for="drv-status"><span class="required">*</span> Driver Status:</label>
      <div class="field-control">
        <select data-base="drv-status">
          <option value="">Select</option><option>Active</option><option>Excluded</option><option>Inactive</option>
        </select>
      </div>

      <label class="field-label" data-for="drv-experience"><span class="required">*</span> Years Experience:</label>
      <div class="field-control"><input data-base="drv-experience" type="number" min="0" /></div>

      <label class="field-label" data-for="drv-lic-status"><span class="required">*</span> Driver License Status:</label>
      <div class="field-control">
        <select data-base="drv-lic-status">
          <option value="">Select</option><option>Valid</option><option>Suspended</option><option>Expired</option><option>Permit</option>
        </select>
      </div>

      <label class="field-label" data-for="drv-cdl">Driver has CDL:</label>
      <div class="field-control">
        <select data-base="drv-cdl">
          <option value="">Select</option><option>Yes</option><option>No</option>
        </select>
      </div>

      <label class="field-label" data-for="drv-license-state"><span class="required">*</span> License State:</label>
      <div class="field-control">
        <select data-base="drv-license-state">
          <option value="">Select</option><option>AL</option><option>AK</option><option>AZ</option><option>AR</option><option>CA</option><option>CO</option><option>CT</option><option>DE</option><option>FL</option><option>GA</option><option>HI</option><option>ID</option><option>IL</option><option>IN</option><option>IA</option><option>KS</option><option>KY</option><option>LA</option><option>ME</option><option>MD</option><option>MA</option><option>MI</option><option>MN</option><option>MS</option><option>MO</option><option>MT</option><option>NE</option><option>NV</option><option>NH</option><option>NJ</option><option>NM</option><option>NY</option><option>NC</option><option>ND</option><option>OH</option><option>OK</option><option>OR</option><option>PA</option><option>RI</option><option>SC</option><option>SD</option><option>TN</option><option>TX</option><option>UT</option><option>VT</option><option>VA</option><option>WA</option><option>WV</option><option>WI</option><option>WY</option>
        </select>
      </div>

      <label class="field-label" data-for="drv-license-num">Driver License Number:</label>
      <div class="field-control"><input data-base="drv-license-num" type="text" /></div>

      <label class="field-label" data-for="drv-prev-license">Prior License:</label>
      <div class="field-control"><input data-base="drv-prev-license" type="text" /></div>

      <label class="field-label" data-for="drv-prev-license-state"><span class="required">*</span> Previous License State:</label>
      <div class="field-control">
        <select data-base="drv-prev-license-state">
          <option value="">Select</option><option>AL</option><option>AK</option><option>AZ</option><option>AR</option><option>CA</option><option>CO</option><option>CT</option><option>DE</option><option>FL</option><option>GA</option><option>HI</option><option>ID</option><option>IL</option><option>IN</option><option>IA</option><option>KS</option><option>KY</option><option>LA</option><option>ME</option><option>MD</option><option>MA</option><option>MI</option><option>MN</option><option>MS</option><option>MO</option><option>MT</option><option>NE</option><option>NV</option><option>NH</option><option>NJ</option><option>NM</option><option>NY</option><option>NC</option><option>ND</option><option>OH</option><option>OK</option><option>OR</option><option>PA</option><option>RI</option><option>SC</option><option>SD</option><option>TN</option><option>TX</option><option>UT</option><option>VT</option><option>VA</option><option>WA</option><option>WV</option><option>WI</option><option>WY</option>
        </select>
      </div>

      <label class="field-label" data-for="drv-prev-license-province">Previous License Province:</label>
      <div class="field-control"><input data-base="drv-prev-license-province" type="text" /></div>

      <label class="field-label" data-for="drv-prev-dl-num"><span class="required">*</span> Previous DL Number:</label>
      <div class="field-control"><input data-base="drv-prev-dl-num" type="text" /></div>

      <label class="field-label" data-for="drv-violations">Violations/Accidents:</label>
      <div class="field-control"><input data-base="drv-violations" type="text" /></div>

      <label class="field-label" data-for="drv-email">Email:</label>
      <div class="field-control"><input data-base="drv-email" type="email" /></div>

      <label class="field-label" data-for="drv-cell">Cell Phone:</label>
      <div class="field-control"><input data-base="drv-cell" type="tel" /></div>
    </div>
  </div>
</template>

<script>
  (() => {
    const driverCountInput = document.getElementById('driver-count');
    const driverContainer = document.getElementById('driverContainer');
    const template = document.getElementById('driverTemplate');
    const navPrev = document.querySelector('.driver-nav.prev');
    const navNext = document.querySelector('.driver-nav.next');

    function scrollDrivers(direction = 1) {
      const step = driverContainer.clientWidth * 0.8;
      driverContainer.scrollBy({ left: step * direction, behavior: 'smooth' });
    }

    function renderDrivers(count) {
      driverContainer.innerHTML = '';
      for (let i = 1; i <= count; i += 1) {
        const clone = template.content.cloneNode(true);
        const card = clone.querySelector('.driver-card');
        card.dataset.driver = String(i);
        const label = clone.querySelector('.driver-label');
        if (label) label.textContent = i;

        clone.querySelectorAll('[data-base]').forEach((el) => {
          const base = el.getAttribute('data-base');
          const id = `${base}-${i}`;
          el.id = id;
          el.name = id;
        });

        clone.querySelectorAll('[data-for]').forEach((el) => {
          const base = el.getAttribute('data-for');
          el.setAttribute('for', `${base}-${i}`);
        });

        driverContainer.appendChild(clone);
      }
    }

    function clampDriverCount(val) {
      return Math.max(1, Math.min(val || 1, 10));
    }

    driverCountInput.addEventListener('input', (e) => {
      const safeCount = clampDriverCount(Number(e.target.value));
      e.target.value = safeCount;
      renderDrivers(safeCount);
      driverContainer.scrollTo({ left: 0, behavior: 'auto' });
    });
    if (navPrev) navPrev.addEventListener('click', () => scrollDrivers(-1));
    if (navNext) navNext.addEventListener('click', () => scrollDrivers(1));

    renderDrivers(clampDriverCount(Number(driverCountInput.value)));
  })();
</script>
